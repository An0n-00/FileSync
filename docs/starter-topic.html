<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-03-13T16:18:46.9497019"><title>FileSync - Group 004 | FileSync</title><script type="application/json" id="virtual-toc-data">[{"id":"introduction","level":0,"title":"Introduction","anchor":"#introduction"},{"id":"what-is-filesync","level":0,"title":"What is FileSync?","anchor":"#what-is-filesync"},{"id":"layout","level":0,"title":"Layout","anchor":"#layout"},{"id":"script","level":0,"title":"Script","anchor":"#script"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.css" rel="stylesheet"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><meta name="msapplication-TileColor" content="#000000"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="FileSync - Group 004 | FileSync"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="FileSync Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://an0n-00.github.io/FileSync/docs/0.0.0.5/starter-topic.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="FileSync - Group 004 | FileSync"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "https://an0n-00.github.io/FileSync/docs/0.0.0.5/starter-topic.html#webpage",
    "url": "https://an0n-00.github.io/FileSync/docs/0.0.0.5/starter-topic.html",
    "name": "FileSync - Group 004 | FileSync",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "https://an0n-00.github.io/FileSync/docs/#website",
    "url": "https://an0n-00.github.io/FileSync/docs/",
    "name": "FileSync Help"
}</script><!-- End Schema.org --></head><body data-id="starter-topic" data-main-title="FileSync - Group 004" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>FileSync 0.0.0.5 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="starter-topic" id="starter-topic.md">FileSync - Group 004</h1><section class="chapter"><h2 id="introduction" data-toc="introduction">Introduction</h2><p id="26701cb7_34281">We decided to do a FileSync script with advanced features in order to achieve the best possible grade.</p><section class="chapter"><h3 id="concretization-of-the-task" data-toc="concretization-of-the-task">Concretization of the task</h3><p id="26701cb7_34282">We decided to create our script based on the suggestion from Mr. Waldvogel. That we dont only create his example, we added some of our own features, like remembering the source and destinationpath, removing all information, sync level 1 files only and many more.</p></section><section class="chapter"><h3 id="user-story" data-toc="user-story">User Story</h3><p id="26701cb7_34283">The use case of this script is, when User X wants to sync his files on his drives, but wants to sync only the files in the first level of his source directory and wants to remove the other files, that exist there and not in the source directory, then this script is exactly what he is looking for.</p></section></section><section class="chapter"><h2 id="what-is-filesync" data-toc="what-is-filesync">What is FileSync?</h2><p id="26701cb7_34284">FileSync is a PowerShell tool that synchronizes files between two locations and logs the changes. There are many more features that you can explore.</p><figure id="26701cb7_34285"><img alt="Booting.png" src="images/Booting.png" class="article__bordered-element--rounded" title="Booting.png" width="821" height="503"></figure><section class="chapter"><h3 id="features" data-toc="features">Features</h3><p id="26701cb7_34286">FileSync has the following features:</p><ul class="list _ul" id="26701cb7_34287"><li class="list__item" id="26701cb7_34288"><p>Synchronizes files between two locations</p></li><li class="list__item" id="26701cb7_34289"><p>Logs changes</p></li><li class="list__item" id="26701cb7_34290"><p>Remembers the last source and destination paths</p></li><li class="list__item" id="26701cb7_34291"><p>Copy or move files</p></li><li class="list__item" id="26701cb7_34292"><p>Keep or remove information about the source files</p></li></ul><section class="chapter"><div class="collapse"><div class="collapse__title"><h4 id="and-many-more" data-toc="and-many-more">and many more:</h4></div><div class="collapse__content"><p id="26701cb7_34293">A full list of features:</p><ul class="list _ul" id="26701cb7_34294"><li class="list__item" id="26701cb7_34295"><p>Synchronizes files between two locations</p></li><li class="list__item" id="26701cb7_34296"><p>Logs changes</p></li><li class="list__item" id="26701cb7_34297"><p>Remembers the last source and destination paths</p></li><li class="list__item" id="26701cb7_34298"><p>Copy or move files and directories</p></li><li class="list__item" id="26701cb7_34299"><p>Copy or move files and directories from source to destination or destination to source</p></li><li class="list__item" id="26701cb7_34300"><p>Keep or remove information about the source files</p></li><li class="list__item" id="26701cb7_34301"><p>Copy or move files and directories from all levels or level 1 only</p></li><li class="list__item" id="26701cb7_34302"><p>Remove files from the destination that dont exist in the source anymore</p></li><li class="list__item" id="26701cb7_34303"><p>Remove the script files in a clean and proper way. (Does not leave file traces)</p></li></ul></div></div></section></section></section><section class="chapter"><h2 id="layout" data-toc="layout">Layout</h2><p id="26701cb7_34304">We opted for a console layout, because we found that more time efficient than creating an extra GUI. We did however make the console as user-friendly as possible. (see picture above and below)</p><figure id="26701cb7_34305"><img alt="Menu.png" src="images/Menu.png" class="article__bordered-element--rounded" title="Menu.png" width="1184" height="739"></figure><p id="26701cb7_34306">For the program procedure, see the picture below.</p></section><section class="chapter"><h2 id="script" data-toc="script">Script</h2><aside class="prompt" data-type="note" data-title="" id="26701cb7_34307"><p id="26701cb7_34308"><span class="control" id="26701cb7_34309">FileSync minimum requirements</span></p><p id="26701cb7_34310">This tool requires PowerShell 7 or later. Otherwise, it can cause unwanted loops. See Test 3</p></aside><ol class="list _decimal" id="26701cb7_34311" type="1"><li class="list__item" id="26701cb7_34312"><p>We defined the variables that were Script wide important at the beginning.</p></li></ol><div class="code-block" data-lang="bash"># Variables
[int] $menuinput # User input for menu selection
[string] $syncoptions # Sync options
# Project related variables
[string] $ProjectName = &quot;FileSync&quot;
[string] $ProjectVersion = &quot;0.0.0.6&quot;
[string] $Tempfolder = [Environment]::GetFolderPath( 'LocalApplicationData' ) + &quot;\FileSync&quot;
# Source and destination paths for file synchronization
[string] $Sourcepath = &quot;&quot;
[string] $Destinationpath = &quot;&quot;
# File paths for settings and logs
[string] $settingsFilePath = &quot;$Tempfolder\Settings.dll&quot;
[string] $ErrorLogFilePath = &quot;$Tempfolder\ErrorLog.log&quot;
[string] $logFilePath = &quot;$Tempfolder\FileSync.log&quot;
[string] $logMessage
[int] $corrupted
# Sync options as strings
[string] $00000 = &quot;[all contents]`n[Source to Destination]`n[without deleting files and directories that no longer exist in the source]`n[keeping all file information]`n[copying files and directories]&quot;
#for each option...</div><ol class="list _decimal" id="26701cb7_34314" type="1" start="2"><li class="list__item" id="26701cb7_34315"><p>We created multiple functions in order to handle the different phases of the script. Our logic of the script is following:</p></li></ol><section class="procedure-steps"><h3 id="process" data-toc="process">Script process</h3><ol class="list _decimal"><li class="list__item" id="26701cb7_34316"><p id="26701cb7_34317">The first time you start FileSync, it checks with the function: <kbd class="keystroke" id="26701cb7_34318" data-bypass="true"><span class="keystroke__value">Startup</span></kbd> if all resource files exist and if they do it reads out the information from the important files. We achieved that by importing the settings' content and checked if the line matched with the line we were looking for. After it did, we used regex techniques to save them globally to the corresponding variable (see ln: 651 - 674). However, if one or all of the files were missing or corrupted, <kbd class="keystroke" id="26701cb7_34319" data-bypass="true"><span class="keystroke__value">Startup</span></kbd> would call a new function called <kbd class="keystroke" id="26701cb7_34320" data-bypass="true"><span class="keystroke__value">Setup</span></kbd> with the correct parameters and that would create the missing or corrupted file*s.</p></li><li class="list__item" id="26701cb7_34321"><p id="26701cb7_34322">If there are some problems while booting, the function <kbd class="keystroke" id="26701cb7_34323" data-bypass="true"><span class="keystroke__value">Setup</span></kbd> would jump into action with the correct parameters. It would create the file*s and fill them with the correct content. (see ln: 720 - 859)</p></li><li class="list__item" id="26701cb7_34324"><p id="26701cb7_34325">If it booted correctly, <kbd class="keystroke" id="26701cb7_34326" data-bypass="true"><span class="keystroke__value">Startup</span></kbd> calls the function <kbd class="keystroke" id="26701cb7_34327" data-bypass="true"><span class="keystroke__value">Menu</span></kbd>. This prints the menu as seen below. From there we can choose many different options. (see ln: 65 - 164)</p><div class="code-block" data-lang="bash">===========================================
| FileSync (ver.0.0.0.6)                  |
|_________________________________________|
| (1) Sync now                            |
| (2) Current Configuration               |
| (3) Reconfigure                         |
| (4) Open Log                            |
| (5) Help                                |
|                                         |
| (95) Remove all Information             |
| (99) Exit                               |
|_________________________________________|
Please select an option:</div></li><li class="list__item" id="26701cb7_34329"><p id="26701cb7_34330">The next function we will look at, are the <kbd class="keystroke" id="26701cb7_34331" data-bypass="true"><span class="keystroke__value">preSync</span></kbd> and <kbd class="keystroke" id="26701cb7_34332" data-bypass="true"><span class="keystroke__value">FileSync</span></kbd> functions (<kbd class="keystroke" id="26701cb7_34333" data-bypass="true"><span class="keystroke__value">preSync</span></kbd> is called in option 1 of the <kbd class="keystroke" id="26701cb7_34334" data-bypass="true"><span class="keystroke__value">menu</span></kbd>). In the preSync function we did something very interesting. Instead of adding multiple if-else Statements and then run the result with those options, we decided to create an encoding. After each question we added the Input (0 or 1) to the variable <code class="code" id="26701cb7_34335">[string] $syncoptions # Sync options</code>. This meant that at the end of five questions we would have filled <code class="code" id="26701cb7_34336">$syncoptions</code> with 0 or 1 and that meant, we could use a switch to call up the <kbd class="keystroke" id="26701cb7_34337" data-bypass="true"><span class="keystroke__value">FileSync</span></kbd> function with the encoding (see ln: 165 - 497). Example: <code class="code" id="26701cb7_34338">FileSync -run_what $robocopy_10100 -write_what $10100</code>. Now we had a very small <kbd class="keystroke" id="26701cb7_34339" data-bypass="true"><span class="keystroke__value">FileSync</span></kbd> function, because the decision-making was done already in the <kbd class="keystroke" id="26701cb7_34340" data-bypass="true"><span class="keystroke__value">preSync</span></kbd>. In the <kbd class="keystroke" id="26701cb7_34341" data-bypass="true"><span class="keystroke__value">FileSync</span></kbd> function we also added a switch to check the return codes from robocopy and print the corresponding message. (We used <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/robocopy" id="26701cb7_34342" data-external="true" rel="noopener noreferrer">robocopy</a> for the syncing, as it is very handy and extra built for such operations). This would not have worked, if we had moved the variable decleration block in <kbd class="keystroke" id="26701cb7_34343" data-bypass="true"><span class="keystroke__value">preSync</span></kbd> to the beginning of the script, since the source and destination paths should only be filled into the commands <b id="26701cb7_34344">after</b> they were known! (see FileSync ln: 498 - 572 and PreSync ln: 165 - 497)</p></li><li class="list__item" id="26701cb7_34345"><p id="26701cb7_34346">One last function we will look at is the <kbd class="keystroke" id="26701cb7_34347" data-bypass="true"><span class="keystroke__value">log</span></kbd> function. Since we log almost everything the script does, we decided to create a log function. This log function required two things. Firstly the log message and secondly the log level (level 1 being log and level 2 being error). What the logging function does is, it adds to the message &quot;at dd-MM-yyyy HH:mm.sss&quot; and then appends it to the log file. Now the smart part: Instead of always crashing when the log file does not exist, it just returns to the place it came from. This is very smart, because we then don't have to take care of the File-not-found error when the user deletes the log file while FileSync is running.</p></li></ol></section><p> Please note, that we did not explain all the functions but rather the most important ones.</p></section><div class="last-modified">Last modified: 13 March 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.js"></script></body></html>